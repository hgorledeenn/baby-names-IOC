labs(
title="% Difference in occurrences of names between females and males",
subtitle = str_wrap("Positive values show a name is more common among women, negative show a name is more common among men.", width=65),
x = "Names",
y = "Percent difference in occurrences of name by gender",
fill = str_wrap("Total Name Count", width=15)
) +
theme(
axis.text.x = element_text(size = 10, angle=270)
)
horizontal_bars <- df_only_mandf %>%
ggplot() +
aes(x=reorder(name, -pct_diff), y=pct_diff, fill=diff_size) +
geom_bar(stat="identity") +
coord_flip() +
labs(
title = str_wrap("% Difference in occurrences of names between females and males", width=65),
subtitle = str_wrap("Positive values show a name is more common among women, negative show a name is more common among men.", width=65),
x = "Names",
y = "Percent difference in occurrences of name by gender",
fill = str_wrap("Total Name Count", width=15)
) +
theme(
axis.text.y = element_text(size = 10, angle=0)
)
df_only_mandf
ggsave("column_chart_1.png",
plot = vertical_cols,
width = 8,
height = 6,
units = "in",
dpi = 300)
ggsave("bar_chart_1.png",
plot = horizontal_bars,
width = 7,
height = 8,
units = "in",
dpi = 300)
mutate(mutate(pct_diff = (FEMALE-MALE)/(FEMALE+MALE))
df_no_ethn <- df %>%
library(tidyverse)
df = read_csv("~/Desktop/CJS/0126algorithms/HW-in-one-chart-1/BABY NAMES/Popular_Baby_Names_20260203.csv")
df <- df %>%
mutate(name = str_to_title(`Child's First Name`))
df_no_ethn <- df %>%
group_by(`Year of Birth`, Gender, name) %>%
summarize(sum_count = sum(Count)) %>%
pivot_wider(names_from = Gender, values_from = sum_count, values_fill = 0)
View(df_no_ethn)
df_no_ethn <- df %>%
group_by(`Year of Birth`, Gender, name) %>%
summarize(sum_count = sum(Count)) %>%
pivot_wider(names_from = Gender, values_from = sum_count, values_fill = 0) %>%
mutate(pct_diff = (FEMALE-MALE)/(FEMALE+MALE))
df_no_ethn_diff_byyear <- df_no_ethn %>%
pivot_wider(names_from = `Year of Birth`, values_from = pct_diff)
View(df_no_ethn_diff_byyear)
df_no_ethn_diff_byyear <- df_no_ethn %>%
pivot_wider(names_from = `Year of Birth`, values_from = pct_diff) %>%
select(-FEMALE, -MALE)
View(df_no_ethn_diff_byyear)
df_no_ethn_diff_byyear %>%
ggplot()
df_no_ethn %>%
ggplot() +
aes(x=`Year of Birth`, y=pct_diff)
df_no_ethn %>%
ggplot() +
aes(x=`Year of Birth`, y=pct_diff) +
geom_line()
df_no_ethn %>%
ggplot() +
aes(x=`Year of Birth`, y=pct_diff) +
geom_line(stat="name")
df_no_ethn %>%
ggplot() +
aes(x=`Year of Birth`, y=pct_diff) +
geom_line(stat="identity")
df_no_ethn %>%
ggplot() +
aes(x=`Year of Birth`, y=pct_diff, color=name) +
geom_line()
df_no_ethn %>%
ggplot() +
aes(x=`Year of Birth`, y=pct_diff, color=name) +
geom_line
df_no_ethn %>%
ggplot() +
aes(x=`Year of Birth`, y=pct_diff, color=name) +
geom_line()
df_no_ethn %>%
ggplot() +
aes(x=`Year of Birth`, y=pct_diff, group=name) +
geom_line()
df_no_ethn %>%
ggplot() +
aes(x=`Year of Birth`, y=pct_diff, group=name, color=name) +
geom_line()
df_no_ethn %>%
ggplot() +
aes(x=`Year of Birth`, y=pct_diff, group=name) +
geom_line()
df_no_ethn %>%
ggplot() +
aes(x=`Year of Birth`, y=pct_diff, group=name) +
geom_line(alpha=0.1)
df_no_ethn <- df %>%
group_by(`Year of Birth`, Gender, name) %>%
summarize(sum_count = sum(Count)) %>%
pivot_wider(names_from = Gender, values_from = sum_count, values_fill = 0) %>%
mutate(pct_diff = (FEMALE-MALE)/(FEMALE+MALE)) %>%
mutate(total_count = (FEMALE+MALE))
df_no_ethn %>%
ggplot() +
aes(x=`Year of Birth`, y=pct_diff, group=name, color=total_count) +
geom_line(alpha=0.1)
df_no_ethn %>%
ggplot() +
aes(x=`Year of Birth`, y=pct_diff, group=name, color=total_count) +
geom_line(alpha=0.5)
df_no_ethn %>%
ggplot() +
aes(x=`Year of Birth`, y=pct_diff, group=name, color=total_count) +
geom_line(alpha=total_count)
df_no_ethn %>%
ggplot() +
aes(x=`Year of Birth`, y=pct_diff, group=name, alpha=total_count) +
geom_line()
df_no_ethn %>%
ggplot() +
aes(x=`Year of Birth`, y=pct_diff, group=name, alpha=total_count) +
geom_line()
df = read_csv("~/Desktop/CJS/0126algorithms/HW-in-one-chart-1/BABY NAMES/Popular_Baby_Names_20260203.csv")
library(tidyverse)
df = read_csv("~/Desktop/CJS/0126algorithms/HW-in-one-chart-1/BABY NAMES/Popular_Baby_Names_20260203.csv")
df <- df %>%
mutate(name = str_to_title(`Child's First Name`))
df_no_ethn <- df %>%
group_by(`Year of Birth`, Gender, name) %>%
summarize(sum_count = sum(Count)) %>%
pivot_wider(names_from = Gender, values_from = sum_count, values_fill = 0) %>%
mutate(pct_diff = (FEMALE-MALE)/(FEMALE+MALE)) %>%
mutate(total_count = (FEMALE+MALE))
df_no_ethn_diff_byyear <- df_no_ethn %>%
pivot_wider(names_from = `Year of Birth`, values_from = pct_diff) %>%
select(-FEMALE, -MALE)
df_no_ethn %>%
ggplot() +
aes(x=`Year of Birth`, y=pct_diff, group=name, alpha=total_count) +
geom_line()
View(df)
View(df_no_ethn)
View(df)
View(df_no_ethn_diff_byyear)
library(tidyverse)
library(glue)
library(ggrepel)
setwd("~/Desktop/CJS/0126algorithms/HW-in-one-chart-1/BABY NAMES")
df = read_csv("~/Desktop/CJS/0126algorithms/HW-in-one-chart-1/BABY NAMES/Popular_Baby_Names_20260203.csv")
df <- df %>%
mutate(name = str_to_title(`Child's First Name`))
df <- df %>%
mutate(name = str_to_title(`Child's First Name`)) %>%
select(-`Child's First Name`)
View(df)
View(df)
View(df)
df_no_ethn <- df %>%
group_by(`Year of Birth`, Gender, name) %>%
summarize(sum_count = sum(Count)) %>%
pivot_wider(names_from = Gender, values_from = sum_count, values_fill = 0) %>%
mutate(pct_diff = (FEMALE-MALE)/(FEMALE+MALE)) %>%
mutate(total_count = (FEMALE+MALE))
View(df_no_ethn)
library(tidyverse)
library(glue)
library(ggrepel)
setwd("~/Desktop/CJS/0126algorithms/HW-in-one-chart-1/BABY NAMES")
df = read_csv("~/Desktop/CJS/0126algorithms/HW-in-one-chart-1/BABY NAMES/Popular_Baby_Names_20260203.csv")
df <- df %>%
mutate(name = str_to_title(`Child's First Name`)) %>%
select(-`Child's First Name`)
## 1. Remove "ethnicity" variable and group remaining results by year, gender & name
df_one_row_per_name <- df %>%
group_by(`Year of Birth`, Gender, name) %>%
summarize(sum_count = sum(Count)) %>%
## 2. Pivot wider to create only 1 name per row, with columns for Male and Female counts
pivot_wider(names_from = Gender, values_from = sum_count, values_fill = 0) %>%
## 3. Create column showing percentage difference between male and female counts
##    (all female = 1, all male = -1)
mutate(pct_diff = (FEMALE-MALE)/(FEMALE+MALE)) %>%
mutate(total_count = (FEMALE+MALE))
wide_with_var <- df_one_row_per_name %>%
select(name, `Year of Birth`, pct_diff) %>%
pivot_wider(
names_from = `Year of Birth`,
values_from = pct_diff
) %>%
rowwise() %>%
mutate(
variance = var(c_across(`2011`:`2021`), na.rm = TRUE)
) %>%
ungroup() %>%
select(name, variance, `2011`:`2021`) %>%
mutate(sum_pct_diff = rowSums(wide_with_var[c("2011","2012","2013","2014","2015","2016","2017","2018","2019","2020","2021")], na.rm=TRUE))
wide_with_var <- df_one_row_per_name %>%
select(name, `Year of Birth`, pct_diff) %>%
pivot_wider(
names_from = `Year of Birth`,
values_from = pct_diff
) %>%
rowwise() %>%
mutate(
variance = var(c_across(`2011`:`2021`), na.rm = TRUE)
) %>%
ungroup() %>%
select(name, variance, `2011`:`2021`) %>%
mutate(sum_pct_diff = rowSums([c("2011","2012","2013","2014","2015","2016","2017","2018","2019","2020","2021")], na.rm=TRUE))
wide_with_var <- df_one_row_per_name %>%
select(name, `Year of Birth`, pct_diff) %>%
pivot_wider(
names_from = `Year of Birth`,
values_from = pct_diff
) %>%
rowwise() %>%
mutate(
variance = var(c_across(`2011`:`2021`), na.rm = TRUE)
) %>%
ungroup() %>%
select(name, variance, `2011`:`2021`) %>%
mutate(sum_pct_diff = rowSums(c("2011","2012","2013","2014","2015","2016","2017","2018","2019","2020","2021"), na.rm=TRUE))
View(df_one_row_per_name)
## Add sum column for measuring total of pct_diff over time per name
##    (used for assigning ranks to order plots for animation)
wide_with_var <- wide_with_var %>%
mutate(sum_pct_diff = rowSums(wide_with_var[c("2011","2012","2013","2014",
"2015","2016","2017","2018",
"2019","2020","2021")], na.rm=TRUE))
## Load necessary packages
library(tidyverse)
library(glue)
library(ggrepel)
## Set WD and read in data
setwd("~/Desktop/CJS/0126algorithms/HW-in-one-chart-1/BABY NAMES")
df = read_csv("~/Desktop/CJS/0126algorithms/HW-in-one-chart-1/BABY NAMES/Popular_Baby_Names_20260203.csv")
## Make sure each name is formatted consistently (helps with grouping by name later)
df <- df %>%
mutate(name = str_to_title(`Child's First Name`)) %>%
select(-`Child's First Name`)
## 1. Remove "ethnicity" variable and group remaining results by year, gender & name
df_one_row_per_name_yr <- df %>%
group_by(`Year of Birth`, Gender, name) %>%
summarize(sum_count = sum(Count)) %>%
## 2. Pivot wider to create only one row per name/year combo, with columns for Male and Female counts
pivot_wider(names_from = Gender, values_from = sum_count, values_fill = 0) %>%
## 3. Create column showing percentage difference between male and female counts
##    (all female = 1, all male = -1)
mutate(pct_diff = (FEMALE-MALE)/(FEMALE+MALE)) %>%
mutate(total_count = (FEMALE+MALE))
## Create a DF with only one row per name, columns for yearly pct_diff (NA where count=0)
wide_with_var <- df_one_row_per_name_yr %>%
select(name, `Year of Birth`, pct_diff) %>%
pivot_wider(
names_from = `Year of Birth`,
values_from = pct_diff
) %>%
rowwise() %>%
## Add variance column showing variance in pct_diff over time
mutate(
variance = var(c_across(`2011`:`2021`), na.rm = TRUE)
) %>%
ungroup() %>%
select(name, variance, `2011`:`2021`)
View(wide_with_var)
## Add sum column for measuring total of pct_diff over time per name
##    (used for assigning ranks to order plots for animation)
wide_with_var <- wide_with_var %>%
mutate(sum_pct_diff = rowSums(wide_with_var[c("2011","2012","2013","2014",
"2015","2016","2017","2018",
"2019","2020","2021")], na.rm=TRUE))
View(wide_with_var)
## Create dataframe for intermediate step of creating a list of names with variance>0
only_w_variance <- wide_with_var %>%
filter(variance>0)
View(only_w_variance)
## Save the list of names with variance>0 for later reference
variance_list <- only_w_variance$name
## Add sum column for measuring total of pct_diff over time per name
##    (used for assigning ranks to order plots for animation)
wide_with_var <- wide_with_var %>%
mutate(sum_pct_diff = rowSums(wide_with_var[c("2011","2012","2013","2014",
"2015","2016","2017","2018",
"2019","2020","2021")], na.rm=TRUE))
## Create dataframe for intermediate step of creating a list of names with variance>0
only_w_variance <- wide_with_var %>%
filter(variance>0)
## Save the list of names with variance>0 for later reference
variance_list <- only_w_variance$name
## Save the list of names with variance>0 for later reference
variance_list <- only_w_variance$name
## Filter larger dataframe to only names contained in variance_list
wide_with_var <- wide_with_var %>%
filter(name %in% variance_list) %>%
## Sort first by sum_pct_diff, higher values first
arrange(
desc(sum_pct_diff),
## If ties exist, sort by variance, higher values first
desc(variance),
## If ties exist, sort alphabetically
name
) %>%
mutate(
## Add rank as row # of sorted dataframe
rank = row_number()
)
View(wide_with_var)
df_with_var <- df_one_row_per_name_yr %>%
filter(name %in% variance_list)
View(df_with_var)
## Making individual plots for ANIMATION GRAPHIC
for (i in variance_list) {
## 1. Define current rank for file naming later
current_rank <- wide_with_var %>%
filter(name == i) %>%
pull(rank)
p <- ggplot(data = df_with_var) +
aes(x=`Year of Birth`, y=pct_diff, group=name) +
## 2. Add all names as gray lines in the background
geom_line(color="grey50", linewidth=0.5) +
## 3. Highlight the y=0 line in black to improve readability of later text annotations
geom_hline(yintercept = 0, color = "black", linewidth = 0.5) +
## 4. Add highlighted name as thicker red line on top
geom_line(data = filter(df_with_var, name==i), color = "red", linewidth=1) +
## 5. Add "More Female" and "More Male" text annotations in black to improve readability of chart
annotate("text",
x = 2021, y = 0.1,
label = "More Female ↑",
color = "black", size = 5,
fontface = "bold", alpha=0.9, hjust=1) +
annotate("text",
x = 2021, y = -0.1,
label = "More Male ↓",
color = "black", size = 5,
fontface = "bold", alpha=0.9, hjust=1) +
## 6. Add the highlighted name as a text annotation
annotate("text",
x = 2011.25, y = 0.8,
label = i,
color = "grey20", size = 26,
fontface = "bold", alpha=0.6, hjust=0, vjust=1) +
labs(
x = "Year of Birth",
y = "Gender Difference"
)
filename <- paste0("for_animating/", current_rank, "-", i, ".png")
ggsave(filename, plot=p, width = 6, height = 4, units = "in")
}
## Load necessary packages
library(tidyverse)
library(glue)
library(ggrepel)
## Set WD and read in data
setwd("~/Desktop/CJS/0126algorithms/HW-in-one-chart-1/BABY NAMES")
df = read_csv("~/Desktop/CJS/0126algorithms/HW-in-one-chart-1/BABY NAMES/Popular_Baby_Names_20260203.csv")
## Make sure each name is formatted consistently (helps with grouping by name later)
df <- df %>%
mutate(name = str_to_title(`Child's First Name`)) %>%
select(-`Child's First Name`)
## 1. Remove "ethnicity" variable and group remaining results by year, gender & name
df_one_row_per_name_yr <- df %>%
group_by(`Year of Birth`, Gender, name) %>%
summarize(sum_count = sum(Count)) %>%
## 2. Pivot wider to create only one row per name/year combo, with columns for Male and Female counts
pivot_wider(names_from = Gender, values_from = sum_count, values_fill = 0) %>%
## 3. Create column showing percentage difference between male and female counts
##    (all female = 1, all male = -1)
mutate(pct_diff = (FEMALE-MALE)/(FEMALE+MALE)) %>%
mutate(total_count = (FEMALE+MALE))
## Create a DF with only one row per name, columns for yearly pct_diff (pct_diff is NA where count=0)
wide_with_var <- df_one_row_per_name_yr %>%
select(name, `Year of Birth`, pct_diff) %>%
pivot_wider(
names_from = `Year of Birth`,
values_from = pct_diff
) %>%
rowwise() %>%
## Add variance column showing variance in pct_diff over time
mutate(
variance = var(c_across(`2011`:`2021`), na.rm = TRUE)
) %>%
ungroup() %>%
select(name, variance, `2011`:`2021`)
## Add sum column for measuring total of pct_diff over time per name
##    (used for assigning ranks to order plots for animation)
wide_with_var <- wide_with_var %>%
mutate(sum_pct_diff = rowSums(wide_with_var[c("2011","2012","2013","2014",
"2015","2016","2017","2018",
"2019","2020","2021")], na.rm=TRUE))
## Create dataframe for intermediate step of creating a list of names with variance>0
only_w_variance <- wide_with_var %>%
filter(variance>0)
## Save the list of names with variance>0 for later reference
variance_list <- only_w_variance$name
## Filter larger dataframe to only names contained in variance_list
wide_with_var <- wide_with_var %>%
filter(name %in% variance_list) %>%
## Sort first by sum_pct_diff, higher values first
arrange(
desc(sum_pct_diff),
## If ties exist, sort by variance, higher values first
desc(variance),
## If ties exist, sort alphabetically
name
) %>%
mutate(
## Add rank as row # of sorted dataframe
rank = row_number()
)
## Rather than pivoting wide_with_var to long for ggplot, I filter df_one_row_per_name_yr
##    to only the names in variance_list
df_with_var <- df_one_row_per_name_yr %>%
filter(name %in% variance_list)
## Making the individual plots for EXPLORATORY DATA ANALYSIS
for (i in variance_list) {
## 1. Define/find some variables for later
title <- paste0("All names with variance>0 in the dataset with ", i, " highlighted")
sum <- sum(df_with_var$total_count[df_with_var$name == i])
var <- sum(wide_with_var$variance[wide_with_var$name == i])
current_rank <- wide_with_var %>%
filter(name == i) %>%
pull(rank)
subtitle <- paste0("The name ", i, " appeared ", sum, " times in the dataset and had a variance of ", var, ".")
## 2. Make the plot
p <- ggplot(data = df_with_var) +
aes(x=`Year of Birth`, y=pct_diff, group=name) +
## 3. First geom_line adds all names as black lines
geom_line(color="black", linewidth=0.5) +
## 4. Second geom_line adds the particular name in a thicker red line on top
geom_line(data = filter(df_with_var, name==i), color = "red", linewidth=1) +
## 5. Geom_label_repel adds individual data points as text to the chart, only for the highlighted name
geom_label_repel(data = filter(df_with_var, name==i),
aes(label = paste0(`Year of Birth`, "\nFemale: ", FEMALE, "\nMale: ", MALE)),
fill = "white",
size=2,
alpha=0.9) +
## 6. Reference previously defined variables to add labels
labs(
title = title,
subtitle = str_wrap(subtitle, 60)
)
filename <- paste0("plots/", current_rank, "-", i, ".png")
ggsave(filename, plot=p, width = 6, height = 4, units = "in")
}
## Making individual plots for ANIMATION GRAPHIC
for (i in variance_list) {
## 1. Define current rank for file naming later
current_rank <- wide_with_var %>%
filter(name == i) %>%
pull(rank)
p <- ggplot(data = df_with_var) +
aes(x=`Year of Birth`, y=pct_diff, group=name) +
## 2. Add all names as gray lines in the background
geom_line(color="grey50", linewidth=0.5) +
## 3. Highlight the y=0 line in black to improve readability of later text annotations
geom_hline(yintercept = 0, color = "black", linewidth = 0.5) +
## 4. Add highlighted name as thicker red line on top
geom_line(data = filter(df_with_var, name==i), color = "red", linewidth=1) +
## 5. Add "More Female" and "More Male" text annotations in black to improve readability of chart
annotate("text",
x = 2021, y = 0.1,
label = "More Female ↑",
color = "black", size = 5,
fontface = "bold", alpha=0.9, hjust=1) +
annotate("text",
x = 2021, y = -0.1,
label = "More Male ↓",
color = "black", size = 5,
fontface = "bold", alpha=0.9, hjust=1) +
## 6. Add the highlighted name as a text annotation
annotate("text",
x = 2011.25, y = 0.8,
label = i,
color = "grey20", size = 26,
fontface = "bold", alpha=0.6, hjust=0, vjust=1) +
labs(
x = "Year of Birth",
y = "Gender Difference"
)
filename <- paste0("for_animating/", current_rank, "-", i, ".png")
ggsave(filename, plot=p, width = 6, height = 4, units = "in")
}
df_with_var %>%
ggplot() +
aes(x=`Year of Birth`, y=pct_diff, group=name, color=name) +
geom_line(color="black", linewidth=0.5) +
geom_line(data = filter(df_with_var, name=="Jamie"), color = "red", linewidth=1)
## First viz attempt (OLD)
df_only_mandf %>%
ggplot() +
## 1. Order data by pct_diff
aes(x=reorder(name, -pct_diff), y=pct_diff, fill=diff_size) +
geom_bar(stat="identity") +
labs(
title = str_wrap("% Difference in occurrences of names between females and males", width=65),
subtitle = str_wrap("Positive values show a name is more common among women, negative show a name is more common among men.", width=65),
x = "Names",
y = "Percent difference in occurrences of name by gender",
fill = str_wrap("Total Name Count", width=15)
) +
theme(
axis.text.y = element_text(size = 10, angle=0)
)
